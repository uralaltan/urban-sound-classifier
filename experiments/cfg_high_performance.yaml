# experiments/cfg_high_performance.yaml
# Configuration designed to achieve 90%+ accuracy

seed: 42
device: 'cuda'

# Data paths
csv: 'data/raw/UrbanSound8K/metadata/UrbanSound8K.csv'
audio_root: 'data/raw/UrbanSound8K/audio'

# Use standard UrbanSound8K 10-fold cross-validation setup
# For maximum performance, use 8 folds for training, 1 for validation, 1 for test
train_folds: [ 1, 2, 3, 4, 5, 6, 7, 8 ]  # 8 folds for training (maximum data)
val_folds: [ 9 ]  # 1 fold for validation
test_folds: [ 10 ]  # 1 fold reserved for final testing

# Optimized hyperparameters for high accuracy
batch_size: 24  # Balanced batch size for stability and GPU memory
lr: 0.0008  # Carefully tuned learning rate
epochs: 100  # More epochs for convergence
warmup_epochs: 10  # Learning rate warmup

# Model configuration
model_type: 'custom_urbansound'  # Our custom high-performance model
dropout: 0.15  # Optimal dropout rate
weight_decay: 0.02  # Strong regularization

# Advanced training techniques
use_mixup: true
mixup_alpha: 0.3
label_smoothing: 0.15
gradient_clipping: 1.0

# Data augmentation
augmentation_prob: 0.8  # Apply augmentation 80% of the time
freq_mask_prob: 0.6
time_mask_prob: 0.6
freq_mask_size: 12
time_mask_size: 20

# Learning rate scheduling
scheduler_type: 'cosine_warmup'  # Cosine annealing with warmup
min_lr: 1e-6
patience: 15  # For ReduceLROnPlateau fallback

# Early stopping
early_stopping_patience: 25
early_stopping_min_delta: 0.001

# Model checkpointing
save_top_k: 3  # Save top 3 models
save_every_n_epochs: 10

# Advanced audio preprocessing
sample_rate: 22050
n_mels: 128
n_fft: 2048  # Higher resolution
hop_length: 512
max_frames: 173
f_min: 20.0
f_max: 8000.0

# Test Time Augmentation (TTA)
use_tta: true
tta_steps: 5